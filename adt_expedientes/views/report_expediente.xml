<odoo>

    <!-- QWeb report template for expediente -->
    <template id="report_expediente_body">
        <t t-name="adt_expedientes.report_expediente_body">
            <html>
                <head>
                    <meta charset="utf-8"/>
                </head>
                <body>
                    <main role="main">
                    <t t-foreach="docs" t-as="doc">
                    <div class="page">
                        <h2>Expediente: <t t-esc="doc.id"/> - <t t-esc="doc.cliente_id.name or ''"/></h2>

                        <h3>Datos generales</h3>
                        <table class="table table-sm">
                            <tr>
                                <td><strong>Cliente:</strong></td>
                                <td><t t-esc="doc.cliente_id.name or ''"/></td>
                            </tr>
                            <tr>
                                <td><strong>Asesora:</strong></td>
                                <td><t t-esc="doc.asesora_id.name or ''"/></td>
                            </tr>
                            <tr>
                                <td><strong>Fecha:</strong></td>
                                <td><t t-esc="doc.fecha or ''"/></td>
                            </tr>
                            <tr>
                                <td><strong>Nacionalidad:</strong></td>
                                <td><t t-esc="doc.cliente_nationality"/></td>
                            </tr>
                            <tr>
                                <td><strong>Ocupación:</strong></td>
                                <td><t t-esc="doc.cliente_occupation"/></td>
                            </tr>
                            <tr>
                                <td><strong>Vehículo:</strong></td>
                                <td><t t-esc="dict(doc._fields['vehiculo'].selection).get(doc.vehiculo, doc.vehiculo) if doc.vehiculo else ''"/></td>
                            </tr>
                        </table>

                        <!-- Documents section: keep order as in form -->
                        <h3>Documentos</h3>

                        <!-- DNI / CE / Pasaporte -->
                        <t t-if="(doc.cliente_nationality_code == 'peruana')">
                            <h4>DNI</h4>
                            <table class="table table-sm">
                                <tr>
                                    <td>Anverso</td>
                                    <td>
                                        <t t-if="doc.foto_dni_frente">
                                            <img t-att-src="doc.get_data_uri('foto_dni_frente')" style="max-width:400px; margin:5px;"/>
                                        </t>
                                    </td>
                                </tr>
                                <tr>
                                    <td>Reverso</td>
                                    <td>
                                        <t t-if="doc.foto_dni_reverso">
                                            <img t-att-src="doc.get_data_uri('foto_dni_reverso')" style="max-width:400px; margin:5px;"/>
                                        </t>
                                    </td>
                                </tr>
                                <tr>
                                    <td>Estado</td>
                                    <td><t t-esc="doc.estado_foto_dni or ''"/></td>
                                </tr>
                                <tr>
                                    <td>Observaciones</td>
                                    <td><t t-esc="doc.obs_foto_dni or ''"/></td>
                                </tr>
                            </table>
                        </t>
                        <t t-if="(doc.cliente_nationality_code and doc.cliente_nationality_code != 'peruana')">
                            <h4>Carnet de Extranjería</h4>
                            <table class="table table-sm">
                                <tr>
                                    <td>Anverso</td>
                                    <td>
                                        <t t-if="doc.foto_ce_frente">
                                            <img t-att-src="doc.get_data_uri('foto_ce_frente')" style="max-width:400px; margin:5px;"/>
                                        </t>
                                    </td>
                                </tr>
                                <tr>
                                    <td>Reverso</td>
                                    <td>
                                        <t t-if="doc.foto_ce_reverso">
                                            <img t-att-src="doc.get_data_uri('foto_ce_reverso')" style="max-width:400px; margin:5px;"/>
                                        </t>
                                    </td>
                                </tr>
                                <tr>
                                    <td>Estado</td>
                                    <td><t t-esc="doc.estado_foto_ce or ''"/></td>
                                </tr>
                                <tr>
                                    <td>Observaciones</td>
                                    <td><t t-esc="doc.obs_foto_ce or ''"/></td>
                                </tr>
                            </table>

                            <h4>Pasaporte</h4>
                            <table class="table table-sm">
                                <tr>
                                    <td>Anverso</td>
                                    <td>
                                        <t t-if="doc.foto_pasaporte_frente">
                                            <img t-att-src="doc.get_data_uri('foto_pasaporte_frente')" style="max-width:400px; margin:5px;"/>
                                        </t>
                                    </td>
                                </tr>
                                <tr>
                                    <td>Reverso</td>
                                    <td>
                                        <t t-if="doc.foto_pasaporte_reverso">
                                            <img t-att-src="doc.get_data_uri('foto_pasaporte_reverso')" style="max-width:400px; margin:5px;"/>
                                        </t>
                                    </td>
                                </tr>
                                <tr>
                                    <td>Estado</td>
                                    <td><t t-esc="doc.estado_foto_pasaporte or ''"/></td>
                                </tr>
                                <tr>
                                    <td>Observaciones</td>
                                    <td><t t-esc="doc.obs_foto_pasaporte or ''"/></td>
                                </tr>
                            </table>
                        </t>

                        <!-- Licencia -->
                        <h4>Licencia</h4>
                        <table class="table table-sm">
                            <tr>
                                <td>Imagen</td>
                                <td>
                                    <t t-if="doc.foto_licencia">
                                        <img t-att-src="doc.get_data_uri('foto_licencia')" style="max-width:400px; margin:5px;"/>
                                    </t>
                                </td>
                            </tr>
                            <tr>
                                <td>Estado</td>
                                <td><t t-esc="doc.estado_foto_licencia or ''"/></td>
                            </tr>
                            <tr>
                                <td>Observaciones</td>
                                <td><t t-esc="doc.obs_foto_licencia or ''"/></td>
                            </tr>
                        </table>

                        <!-- Recibo -->
                        <h4>Recibo de luz/agua</h4>
                        <table class="table table-sm">
                            <tr>
                                <td>Imagen</td>
                                <td>
                                    <t t-if="doc.foto_recibo">
                                        <img t-att-src="doc.get_data_uri('foto_recibo')" style="max-width:400px; margin:5px;"/>
                                    </t>
                                </td>
                            </tr>
                            <tr>
                                <td>Estado</td>
                                <td><t t-esc="doc.estado_foto_recibo or ''"/></td>
                            </tr>
                            <tr>
                                <td>Observaciones</td>
                                <td><t t-esc="doc.obs_foto_recibo or ''"/></td>
                            </tr>
                        </table>

                        <!-- Sentinel -->
                        <h4>Sentinel - Score / Deudas</h4>
                        <table class="table table-sm">
                            <tr>
                                <td>Score (Imagen)</td>
                                <td>
                                    <t t-if="doc.foto_sentinel_1">
                                        <img t-att-src="doc.get_data_uri('foto_sentinel_1')" style="max-width:400px; margin:5px;"/>
                                    </t>
                                </td>
                            </tr>
                            <tr>
                                <td>Deudas (Imagen)</td>
                                <td>
                                    <t t-if="doc.foto_sentinel_2">
                                        <img t-att-src="doc.get_data_uri('foto_sentinel_2')" style="max-width:400px; margin:5px;"/>
                                    </t>
                                </td>
                            </tr>
                            <tr>
                                <td>Estado</td>
                                <td><t t-esc="doc.estado_foto_sentinel or ''"/></td>
                            </tr>
                            <tr>
                                <td>Observaciones</td>
                                <td><t t-esc="doc.obs_foto_sentinel or ''"/></td>
                            </tr>
                        </table>

                        <!-- Mototaxista / Non-mototaxista sections -->
                        <t t-if="doc.cliente_occupation_code == 'mototaxista'">
                            <h3>Documentos Mototaxista</h3>
                            <table class="table table-sm">
                                <tr>
                                    <td>Foto en la moto</td>
                                    <td>
                                        <t t-if="doc.foto_moto">
                                            <img t-att-src="doc.get_data_uri('foto_moto')" style="max-width:400px; margin:5px;"/>
                                        </t>
                                    </td>
                                </tr>
                                <tr>
                                    <td>SOAT</td>
                                    <td>
                                        <t t-if="doc.foto_soat">
                                            <img t-att-src="doc.get_data_uri('foto_soat')" style="max-width:400px; margin:5px;"/>
                                        </t>
                                    </td>
                                </tr>
                                <tr>
                                    <td>Tarjeta Propiedad - Frente</td>
                                    <td>
                                        <t t-if="doc.foto_tarjeta_propiedad_frente">
                                            <img t-att-src="doc.get_data_uri('foto_tarjeta_propiedad_frente')" style="max-width:400px; margin:5px;"/>
                                        </t>
                                    </td>
                                </tr>
                                <tr>
                                    <td>Tarjeta Propiedad - Reverso</td>
                                    <td>
                                        <t t-if="doc.foto_tarjeta_propiedad_reverso">
                                            <img t-att-src="doc.get_data_uri('foto_tarjeta_propiedad_reverso')" style="max-width:400px; margin:5px;"/>
                                        </t>
                                    </td>
                                </tr>
                                <tr>
                                    <td>Estado tarjeta</td>
                                    <td><t t-esc="doc.estado_foto_tarjeta or ''"/></td>
                                </tr>
                                <tr>
                                    <td>Observaciones tarjeta</td>
                                    <td><t t-esc="doc.obs_foto_tarjeta or ''"/></td>
                                </tr>
                                <tr>
                                    <td>Ganancia</td>
                                    <td><t t-esc="doc.ganancia_diaria_mensual or ''"/></td>
                                </tr>
                                <tr>
                                    <td>Tiempo trabajando</td>
                                    <td><t t-esc="doc.tiempo_trabajando or ''"/></td>
                                </tr>
                                <tr>
                                    <td>Empresa asociada</td>
                                    <td><t t-esc="doc.moto_empresa or ''"/></td>
                                </tr>
                                <tr>
                                    <td>Moto propia/alquilada</td>
                                    <td><t t-esc="doc.moto_propiedad or ''"/></td>
                                </tr>
                            </table>
                        </t>
                        <t t-if="doc.cliente_occupation_code != 'mototaxista'">
                            <h3>Documentos Trabajo independiente</h3>
                            <table class="table table-sm">
                                <tr>
                                    <td>Lugar de trabajo</td>
                                    <td>
                                        <t t-if="doc.foto_lugar_trabajo">
                                            <img t-att-src="doc.get_data_uri('foto_lugar_trabajo')" style="max-width:400px; margin:5px;"/>
                                        </t>
                                    </td>
                                </tr>
                                <tr>
                                    <td>Lugar del negocio</td>
                                    <td>
                                        <t t-if="doc.foto_lugar_negocio">
                                            <img t-att-src="doc.get_data_uri('foto_lugar_negocio')" style="max-width:400px; margin:5px;"/>
                                        </t>
                                    </td>
                                </tr>
                                <tr>
                                    <td>Boletas / Contratos / Recibos</td>
                                    <td>
                                        <t t-if="doc.foto_boletas">
                                            <img t-att-src="doc.get_data_uri('foto_boletas')" style="max-width:400px; margin:5px;"/>
                                        </t>
                                    </td>
                                </tr>
                                <tr>
                                    <td>Estado cuenta</td>
                                    <td>
                                        <t t-if="doc.foto_estado_cuenta">
                                            <img t-att-src="doc.get_data_uri('foto_estado_cuenta')" style="max-width:400px; margin:5px;"/>
                                        </t>
                                    </td>
                                </tr>
                                <tr>
                                    <td>Ganancia</td>
                                    <td><t t-esc="doc.ganancia_diaria_mensual_no or ''"/></td>
                                </tr>
                                <tr>
                                    <td>Tiempo trabajando</td>
                                    <td><t t-esc="doc.tiempo_trabajando_no or ''"/></td>
                                </tr>
                            </table>
                        </t>

                        <!-- Vivienda y ubicacion -->
                        <h3>Ubicación y vivienda</h3>
                        <table class="table table-sm">
                            <tr>
                                <td>Ubicación</td>
                                <td>
                                    <t t-if="doc.foto_ubicacion_actual">
                                        <img t-att-src="doc.get_data_uri('foto_ubicacion_actual')" style="max-width:400px; margin:5px;"/>
                                    </t>
                                </td>
                            </tr>
                            <tr>
                                <td>Fachada</td>
                                <td>
                                    <t t-if="doc.foto_fachada_domicilio">
                                        <img t-att-src="doc.get_data_uri('foto_fachada_domicilio')" style="max-width:400px; margin:5px;"/>
                                    </t>
                                </td>
                            </tr>
                            <tr>
                                <td>Tipo de vivienda</td>
                                <td><t t-esc="doc.tipo_vivienda or ''"/></td>
                            </tr>
                            <tr>
                                <td>Propietario contacto</td>
                                <td><t t-esc="doc.propietario_contacto or ''"/></td>
                            </tr>
                            <tr>
                                <td>Tiempo viviendo</td>
                                <td><t t-esc="doc.tiempo_viviendo or ''"/></td>
                            </tr>
                        </table>

                        <!-- Referencias -->
                        <h3>Referencias</h3>
                        <table class="table table-sm">
                            <tr>
                                <td>Ref 1</td>
                                <td><t t-esc="doc.ref_1_name or ''"/> - <t t-esc="doc.ref_1_phone or ''"/> (<t t-esc="doc.ref_1_vinculo or ''"/>)</td>
                            </tr>
                            <tr>
                                <td>Ref 2</td>
                                <td><t t-esc="doc.ref_2_name or ''"/> - <t t-esc="doc.ref_2_phone or ''"/> (<t t-esc="doc.ref_2_vinculo or ''"/>)</td>
                            </tr>
                            <tr>
                                <td>Ref 3</td>
                                <td><t t-esc="doc.ref_3_name or ''"/> - <t t-esc="doc.ref_3_phone or ''"/> (<t t-esc="doc.ref_3_vinculo or ''"/>)</td>
                            </tr>
                            <tr>
                                <td>Ref 4</td>
                                <td><t t-esc="doc.ref_4_name or ''"/> - <t t-esc="doc.ref_4_phone or ''"/> (<t t-esc="doc.ref_4_vinculo or ''"/>)</td>
                            </tr>
                            <tr>
                                <td>Estado referencias</td>
                                <td><t t-esc="doc.estado_referencias or ''"/></td>
                            </tr>
                            <tr>
                                <td>Observaciones referencias</td>
                                <td><t t-esc="doc.obs_referencias or ''"/></td>
                            </tr>
                        </table>

                        <!-- Fase final -->
                        <h3>Fase final</h3>
                        <table class="table table-sm">
                            <tr>
                                <td>Foto entrega</td>
                                <td>
                                    <t t-if="doc.foto_entrega">
                                        <img t-att-src="doc.get_data_uri('foto_entrega')" style="max-width:400px; margin:5px;"/>
                                    </t>
                                </td>
                            </tr>
                            <tr>
                                <td>Placa</td>
                                <td><t t-esc="doc.placa or ''"/></td>
                            </tr>
                            <tr>
                                <td>Chasis</td>
                                <td><t t-esc="doc.chasis or ''"/></td>
                            </tr>
                        </table>

                        <div class="footer">
                            <strong>Estado actual:</strong> <t t-esc="doc.state or ''"/>
                        </div>

                    </div>
                    </t>
                    </main>
                </body>
            </html>
        </t>
     </template>

     <!-- Report action -->
     <record id="action_adt_expediente_report" model="ir.actions.report">
         <field name="name">Expediente - PDF</field>
         <field name="model">adt.expediente</field>
         <field name="report_type">qweb-pdf</field>
        <field name="report_name">adt_expedientes.report_expediente_body</field>
        <field name="report_file">adt_expedientes.report_expediente_body</field>
         <field name="binding_model_id" ref="model_adt_expediente"/>
     </record>

 </odoo>
